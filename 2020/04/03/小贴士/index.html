<!DOCTYPE html>
<html lang="zh-Hansn">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" type="image/png" href="/img/avatar.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="description" content="">
  <meta name="author" content="JiaoPan">
  <meta name="keywords" content="deep learning|computer vision">
  <title>小贴士 ~ 今天的风儿甚是喧嚣 JiaoPan</title>

  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"  >
<link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css"  >
<link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css"  >
<link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css"  >

<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">



  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"  >

<link rel="stylesheet" href="/css/main.css"  >


  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css"  >


<meta name="generator" content="Hexo 4.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>今天的风儿甚是喧嚣 JiaoPan</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">主页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background"
         style="background: url('/img/default.png')no-repeat center center;
           background-size: cover;
           background-attachment: fixed;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              <br>
              
                <p class="mt-3">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>&nbsp;
                  Friday, April 3rd 2020, 2:06 pm
                </p>
              

              <p>
                
                  
                  &nbsp;<i class="far fa-chart-bar"></i>
                  <span class="post-count">
                    3.7k 字
                  </span>&nbsp;
                

                
                  
                  &nbsp;<i class="far fa-clock"></i>
                  <span class="post-count">
                      20 分钟
                  </span>&nbsp;
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  &nbsp;<i class="far fa-eye" aria-hidden="true"></i>&nbsp;
                  <span id="busuanzi_container_page_pv">
                    <span id="busuanzi_value_page_pv"></span> 次
                  </span>&nbsp;
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <h1 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h1><p><strong>Q： Visual Studio 编译工程报错:error C4996: ‘strtok’: This function or variable may be unsafe. Consider using strtok_s instead</strong></p>
<p>工程属性 —&gt;C/C++ —&gt; 预处理器 —&gt; 预处理器定义,添加宏定义</p>
<pre><code class="lang-cpp">_CRT_SECURE_NO_WARNINGS
</code></pre>
<hr>
<p><strong>Q： pthread.h中报错：C2011“timespec”:“struct”类型重定义</strong></p>
<p>tim.h已定义，pthread.h添加如下代码：</p>
<pre><code class="lang-cpp">#if !defined( PTHREAD_H )
#define PTHREAD_H
#define HAVE_STRUCT_TIMESPEC
</code></pre>
<p><strong>Q：Visual Studio 工程编译dll,接口的定义</strong></p>
<p>A：接口的头文件应如下声明：</p>
<pre><code class="lang-cpp">#define LIB_API __declspec(dllexport) //导出函数
extern &quot;C&quot; {
    LIB_API char*   say();
}
</code></pre>
<p><strong>Q：C++调用DLL</strong></p>
<ul>
<li><p>dll的创建</p>
<pre><code class="lang-cpp">//test.h
#ifdef __cplusplus
extern &quot;C&quot; {
#endif
__declspec(dllexport) int add(int a,int b);
#ifdef __cplusplus
}
#endif  // __cplusplus
</code></pre>
<pre><code class="lang-cpp">//test.cpp
#include &quot;test.h&quot;
int add(int a,int b) {
    return a + b;
}
</code></pre>
<p>编译上述工程为dll，即生成test.dll，并复制到调用该dll工程的编译目录</p>
</li>
<li><p>dll的使用</p>
<pre><code class="lang-cpp">#include&lt;Windows.h&gt;
#includ&lt;iostream&gt;
typedef int (*padd)(int,int);
int main(int argc, char *argv[]){
        HMODULE test = LoadLibrary(&quot;test.dll&quot;);
        if (test != NULL){
            padd add = (padd)GetProcAddress(test,&quot;add&quot;);
            if (add != NULL){    
                std::cout &lt;&lt; add(1,0) &lt;&lt; std::endl;
            }
        }
}
</code></pre>
</li>
</ul>
<p><strong>Q:cmake 简单编译命令</strong></p>
<pre><code class="lang-bash">sudo tar -zxvf test
cd test
sudo mkdir build
cd build/

sudo cmake -DCMAKE_INSTALL_PREFIX=/home/test .. #安装目录
sudo make -j4 #编译
sudo make install #安装
sudo ldconfig #更新软连接
</code></pre>
<p><strong>Q: mac安装LLVM</strong></p>
<pre><code class="lang-bash">$ cd where-you-want-llvm-to-live
$ svn co http://llvm.org/svn/llvm-project/llvm/trunk llvm

$ cd llvm/tools
$ svn co http://llvm.org/svn/llvm-project/cfe/trunk clang

$ cd llvm/tools/clang/tools
$ svn co http://llvm.org/svn/llvm-project/clang-tools-extra/trunk extra

$ cd llvm/projects
$ svn co http://llvm.org/svn/llvm-project/compiler-rt/trunk compiler-rt

$ cd llvm
$ mkdir build
$ cd build
$ cmake -G &quot;Unix Makefiles&quot; ..
$ make
$ make install
</code></pre>
<p><strong>Q:cJSON的使用</strong></p>
<pre><code class="lang-cpp">#include &quot;cJSON.h&quot;
cJSON  *root = cJSON_CreateObject();
cJSON  *bboxs = cJSON_CreateArray();
char *resultJson;

cJSON_AddNumberToObject(root, &quot;status&quot;, 1);
cJSON_AddStringToObject(root, &quot;msg&quot;, &quot;detect ok&quot;);
cJSON_AddItemToObject(root, &quot;bboxs&quot;, bboxs);

for (int i = 0; i &lt; 2; i++){
  cJSON  *bbox;
  cJSON_AddItemToArray(bboxs, bbox = cJSON_CreateObject());
  cJSON_AddNumberToObject(bbox, &quot;score&quot;, 99);
  cJSON_AddNumberToObject(bbox, &quot;x&quot;, 1);
  cJSON_AddNumberToObject(bbox, &quot;y&quot;, 2);
  cJSON_AddNumberToObject(bbox, &quot;width&quot;, 3);
  cJSON_AddNumberToObject(bbox, &quot;height&quot;, 4);
}
resultJson = cJSON_PrintUnformatted(result);
</code></pre>
<p><strong>Q:c#调用dll</strong></p>
<p>note:若dll为X64,则c#应编译x64,否则报错</p>
<pre><code class="lang-c#">using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;

namespace test
{
    class Program
    {
        [DllImport(@&quot;facedetection.dll&quot;, EntryPoint = &quot;facedetect&quot;)]
        extern static string facedetect(string src);
        static void Main(string[] args)
        {
            string result = facedetect(&quot;test.jpg&quot;);
            Console.WriteLine(result);
            Console.ReadKey();
        }
    } 
}
</code></pre>
<p><strong>Q：opencv Mat和byte互转</strong></p>
<pre><code class="lang-cpp">unsigned char* matToBytes(Mat image){
   int size = image.total() * image.elemSize();
     unsigned char* bytes = new unsigned char[size];  // you will have to delete[] that later
     std::memcpy(bytes, image.data, size * sizeof(unsigned char));
     return bytes;
}
Mat bytesToMat(unsigned char* bytes,int width,int height){
    Mat image = Mat(height,width,CV_8UC3,bytes).clone(); // make a copy
    return image;
}
</code></pre>
<p><strong>Q:opencv Mat 转std::vector std::vector转std::string</strong></p>
<pre><code class="lang-cpp">cv::Mat output = output.reshape(1, 1);
std::vector&lt;double&gt; vetor = (std::vector&lt;double&gt;)output;
std::stringstream ss;
ss &lt;&lt; std::setprecision(16);//精度设置
std::copy(vector.begin(), vector.end(), std::ostream_iterator&lt;double&gt;(ss, &quot;,&quot;));
std::string values = ss.str();
values.pop_back();//去掉末尾多余的分隔符
std::cout &lt;&lt; values;

Mat convertToMat(std::string str) {
    std::vector&lt;double&gt; v;
    std::stringstream ss(str);
    ss &lt;&lt; std::setprecision(16);
    std::string token;
    while (std::getline(ss, token, &#39;,&#39;)) {
        v.push_back(std::stod(token));
    }
    Mat output = cv::Mat(v, true).reshape(1, 1);
    return output;
}

cv::FileStorage fs(&quot;../features.xml&quot;, cv::FileStorage::WRITE);
fs &lt;&lt; &quot;features&quot; &lt;&lt; output;
fs.release();
</code></pre>
<p><strong>Q: opencv 截取图片的矩形区域</strong></p>
<pre><code class="lang-cpp">rectangle(image, Rect(x, y, w, h), Scalar(0, 255, 0), 2);
Mat dst = image(cv::Range(y,y+h),cv::Range(x,x+w));
</code></pre>
<p><strong>Q: c++时间差计算</strong></p>
<pre><code class="lang-cpp">#include &lt;chrono&gt;
auto start = std::chrono::steady_clock::now();
//do something
auto end = std::chrono::steady_clock::now();
std::chrono::duration&lt;double&gt; elapsed = end - start;
std::cout &lt;&lt; &quot;elapsed:&quot; &lt;&lt; elapsed.count() &lt;&lt;&quot;s&quot;&lt;&lt; std::endl;
</code></pre>
<h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><p><strong>Q：python打包发布</strong></p>
<p>1.项目根目录新建setup.py</p>
<pre><code class="lang-python">from distutils.core import setup
setup(
 name=&#39;test&#39;,  #打包的输出文件名
 version=&#39;1.0.0&#39;,
 py_modules=[&#39;test&#39;] #打包的.py文件
)
</code></pre>
<p>依赖文件 requirements.txt生成</p>
<p>pip freeze &gt; requirements.txt</p>
<pre><code class="lang-text">opencv==3.4.2
numpy==1.16.4
scikit-image==0.15.0
</code></pre>
<p>或者 conda list -e &gt; requirements.txt</p>
<pre><code class="lang-text">numpy=1.16.4
opencv=3.4.2
scikit-image=0.15.0
</code></pre>
<p>2.项目根目录下执行命令</p>
<pre><code class="lang-bash">sudo python setup.py sdist
</code></pre>
<p>生成dist目录且包含test-1.0.0.tar.gz分发包</p>
<p>3.安装：解压分发包并定位到解压目录后执行安装命令</p>
<pre><code class="lang-bash">pip install -r requirements.txt #安装依赖 或者 conda install --yes --file requirements.txt
sudo python setup.py install
</code></pre>
<p>4.使用</p>
<pre><code class="lang-python">import test
test.sayHello();//#调用模块的sayHello方法
</code></pre>
<p><strong>Q:jupyter notebook 运行于指定的conda环境上</strong></p>
<pre><code class="lang-bash">$ conda install nb_conda #重启jupyter notebook 选择kernel即可
</code></pre>
<pre><code class="lang-bash">$ conda info --envs
# conda environments:
#
base                     /Volumes/storage/mac/miniconda3
python36              *  /Volumes/storage/mac/miniconda3/envs/python36
$ jupyter kernelspec list
Available kernels:
  reco_base    /Users/jiaopan/Library/Jupyter/kernels/reco_base
  python3      /Volumes/storage/mac/miniconda3/envs/python36/share/jupyter/kernels/python3
$ cd /Volumes/storage/mac/miniconda3/envs/python36
$ vi kernel.json
{
 &quot;argv&quot;: [
  &quot;/Volumes/storage/mac/miniconda3/envs/python36/bin/python&quot;,#修改
  &quot;-m&quot;,
  &quot;ipykernel_launcher&quot;,
  &quot;-f&quot;,
  &quot;{connection_file}&quot;
 ],
 &quot;display_name&quot;: &quot;Python 3&quot;,
 &quot;language&quot;: &quot;python&quot;
}
</code></pre>
<p><strong>Q:设置jupyter notebook可远程访问</strong></p>
<pre><code class="lang-bash">$ jupyter notebook --generate-config
Writing default config to: /home/adminpc/.jupyter/jupyter_notebook_config.py

$ jupyter notebook password
Enter password: 
Verify password: 
[NotebookPasswordApp] Wrote hashed password to /home/adminpc/.jupyter/jupyter_notebook_config.json

$ vim /home/adminpc/.jupyter/jupyter_notebook_config.py
c.NotebookApp.ip=&#39;*&#39;
# 密钥位于adminpc/.jupyter/jupyter_notebook_config.json
c.NotebookApp.password = &#39;sha1:0f0fe326cb63:0e48570b0b0952dfe72fefb7bd012934968ea428&#39;
c.NotebookApp.open_browser = False
c.NotebookApp.port =8888 

$ jupyter notebook 
[I 14:14:05.933 NotebookApp] Serving notebooks from local directory: /home/adminpc/jiaopan/projects
[I 14:14:05.933 NotebookApp] The Jupyter Notebook is running at:
[I 14:14:05.933 NotebookApp] http://admin-pc:8888/
[I 14:14:05.933 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
</code></pre>
<p><strong>Q:图片转base64编码/base64编码还原图片</strong></p>
<pre><code class="lang-python">def image_to_base64(image):
    image = cv2.imencode(&#39;.jpg&#39;, image)[1]
    image_code = str(base64.b64encode(image))[2:-1]
    return image_code
image = cv2.imread(&quot;test-04-output-0001.jpg&quot;)
print(image_to_base64(image))

def base64_to_image(base64_code):
    # base64解码
    img_data = base64.b64decode(base64_code)
    # 转换为np数组
    img_array = np.fromstring(img_data, np.uint8)
    # 转换成opencv可用格式
    img = cv2.imdecode(img_array, cv2.COLOR_RGB2BGR)
    return img
</code></pre>
<p><strong>时间格式转换</strong></p>
<pre><code class="lang-python">print(datetime.strftime(datetime.now(),&quot;%Y-%m-%d %H:%M:%S&quot;))
print(datetime.strptime(&quot;2021-03-15 02:26:07&quot;,&quot;%Y-%m-%d %H:%M:%S&quot;))

#时间戳转换
timeArray = time.localtime(int(time.time()))
otherStyleTime = time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, timeArray)
print(otherStyleTime)
</code></pre>
<p><strong>Q:调用c++库文件</strong></p>
<pre><code class="lang-python">so = ctypes.cdll.LoadLibrary(&quot;/home/jiaopan/projects/c++/detector-onnx-linux/cmake-build-debug/libdetector.so&quot;)
model_path = bytes(&quot;/home/jiaopan/projects/c++/detector-onnx-linux/model/yolov5s.onnx&quot;, &quot;utf-8&quot;)
status = so.init(model_path, 1)
print(status)
image = bytes(&quot;/home/jiaopan/Downloads/bus.jpg&quot;, &quot;utf-8&quot;)
detectFile = so.detectByFile
detectFile.restype = ctypes.c_char_p
result = detectFile(image, ctypes.c_float(0.5))
result = ctypes.string_at(result, -1).decode(&quot;utf-8&quot;)
print(result)
</code></pre>
<p><strong>Q:读取摄像头/视频流</strong></p>
<pre><code class="lang-python">cap = cv2.VideoCapture(&quot;/home/jiaopan/Downloads/jd2.mp4&quot;)
    index = 0;
    detect = so.detectByBase64
    detect.restype = ctypes.c_char_p
    if cap.isOpened():
        while True:
            ret, frame = cap.read()
            #frame = cv2.resize(frame, (320, 320), interpolation=cv2.INTER_AREA)
            if index % 1 == 0:
                start = datetime.now()
                #cv2.imwrite(&quot;frame.jpg&quot;,frame)
                #result = detectFile(bytes(&quot;frame.jpg&quot;,&quot;utf-8&quot;), ctypes.c_float(0.6))
                image = frame2base64(frame)
                result = detect(image, ctypes.c_float(0.4))
                end = datetime.now()
                print(&quot;time cost:&quot;,(end-start).total_seconds())
                result = ctypes.string_at(result, -1).decode(&quot;utf-8&quot;)
                result = json.loads(result)
                data = result[&quot;data&quot;]
                print(data)
                for box in data:
                    x = int(box[&quot;location&quot;][&quot;x&quot;])
                    y = int(box[&quot;location&quot;][&quot;y&quot;])
                    width = int(box[&quot;location&quot;][&quot;width&quot;])
                    height = int(box[&quot;location&quot;][&quot;height&quot;])
                    cv2.putText(frame, box[&quot;label&quot;], (x, y), cv2.FONT_HERSHEY_COMPLEX, 0.5, (0, 255, 255), 1)
                    cv2.rectangle(frame,(x,y),(x+width,y+height),(255,0,0),2)
            cv2.imshow(&#39;image&#39;, frame)
            k = cv2.waitKey(20)
            index += 1
            # q键退出
            if (k &amp; 0xff == ord(&#39;q&#39;)):
                break

    cap.release()
    cv2.destroyAllWindows()
</code></pre>
<h1 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h1><p><strong>Q：iframe父/子页面互相调用方法</strong></p>
<pre><code class="lang-html">document.getElementById(&quot;iframeId&quot;).contentWindow.childMethod()/childVariable;
parent.parentMethod()/parentVariable
</code></pre>
<h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><p><strong>Q：springboot切面编程实例</strong></p>
<pre><code class="lang-java">@Aspect
@Component
@Slf4j
public class WebLogAspect {
    //定义一个切入点，对该包下的所有函数方法执行前，执行@Before()
    @Pointcut(&quot;execution(public * com.jp.controller..*.*(..))&quot;)
    public void webLog(){}

    @Before(&quot;webLog()&quot;)
    public void doBefore(JoinPoint joinPoint) throws Throwable {
        // 接收到请求，记录请求内容
        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        HttpServletRequest request = attributes.getRequest();

        // 记录下请求内容
        log.info(&quot;URL : &quot; + request.getRequestURL().toString());
        log.info(&quot;HTTP_METHOD : &quot; + request.getMethod());
        log.info(&quot;IP : &quot; + request.getRemoteAddr());
        log.info(&quot;CLASS_METHOD : &quot; + joinPoint.getSignature().getDeclaringTypeName() + &quot;.&quot; + joinPoint.getSignature().getName());
        log.info(&quot;ARGS : &quot; + Arrays.toString(joinPoint.getArgs()));

    }

    @AfterReturning(returning = &quot;ret&quot;, pointcut = &quot;webLog()&quot;)
    public void doAfterReturning(Object ret) throws Throwable {
        // 处理完请求，返回内容
        log.info(&quot;RESPONSE : &quot; + ret);
    }

}
</code></pre>
<p><strong>Q：Mac，MavenReportException: Error while creating archive: Unable to find javadoc command: The environment variable JAVA_HOME is not correctly set</strong></p>
<p>在pom.xml文件中添加javadoc命令的位置</p>
<pre><code>&lt;properties&gt;
     &lt;javadocExecutable&gt;/Library/Java/JavaVirtualMachines/jdk1.8.0_151.jdk/Contents/Home/bin/javadoc&lt;/javadocExecutable&gt;
&lt;/properties&gt;
</code></pre><p><strong>Q：maven引入本地依赖</strong></p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.oracle&lt;/groupId&gt;
    &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt;
    &lt;scope&gt;system&lt;/scope&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;systemPath&gt;${basedir}/lib/ojdbc6-11.2.0.1.0.jar&lt;/systemPath&gt;
&lt;/dependency&gt;

&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;includeSystemScope&gt;true&lt;/includeSystemScope&gt;
                &lt;mainClass&gt;mainclass&lt;/mainClass&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre><p><strong>Q：普通maven项目打包配置</strong></p>
<pre><code class="lang-java">&lt;build&gt;  
 &lt;plugins&gt;  
  &lt;plugin&gt;
     &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
     &lt;version&gt;2.3.2&lt;/version&gt;
     &lt;configuration&gt;
         &lt;source&gt;1.8&lt;/source&gt;
         &lt;target&gt;1.8&lt;/target&gt;
     &lt;/configuration&gt;
  &lt;/plugin&gt;
  &lt;plugin&gt;
        &lt;artifactId&gt; maven-assembly-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
             &lt;descriptorRefs&gt;
             &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;
             &lt;/descriptorRefs&gt;
             &lt;archive&gt;
                  &lt;manifest&gt;
                       &lt;mainClass&gt;jiaopaner.spark.learning.App&lt;/mainClass&gt;
                  &lt;/manifest&gt;
             &lt;/archive&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
             &lt;execution&gt;
                  &lt;id&gt;make-assembly&lt;/id&gt;
                  &lt;phase&gt;package&lt;/phase&gt;
                  &lt;goals&gt;
                       &lt;goal&gt;single&lt;/goal&gt;
                  &lt;/goals&gt;
             &lt;/execution&gt;
        &lt;/executions&gt;
   &lt;/plugin&gt;
 &lt;/plugins&gt;  
&lt;/build&gt;
</code></pre>
<p><strong>Q:springboot-kafka集群</strong></p>
<pre><code class="lang-bash"># 显示启动
./bin/kafka-server-start.sh ./config/server.properties

# 在后台启动
./bin/kafka-server-start.sh -daemon ./config/server.properties

#创建topic
# --create：表示创建
# --zookeeper 后面的参数是zk的集群节点
# --replication-factor 3 ：表示复本数
# --partitions 3：表示分区数
# --topic test：表示topic的主题名称

./bin/kafka-topics.sh --create --zookeeper server01:2181,server02:2181,server03:2181 --replication-factor 3 --partitions 3 --topic test

#查看topic
./bin/kafka-topics.sh --list --zookeeper server01:2181
#删除topic
./bin/kafka-topics.sh --delete --zookeeper server01:2181 --topic test

#生产者命令
/bin/kafka-console-producer.sh --broker-list server01:9092 --topic test

#消费者命令
/bin/kafka-console-consumer.sh --zookeeper server01:2181 --from-beginning --topic test
</code></pre>
<p><strong>Q:maven dependency scope设置</strong></p>
<ul>
<li>provided:编译和测试阶段依赖</li>
</ul>
<pre><code class="lang-bash">&lt;dependency&gt;
    &lt;groupId&gt;org.jiaoper/groupId&gt;
    &lt;artifactId&gt;utils-common&lt;/artifactId&gt;
    &lt;version&gt;3.0-alpha-1&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>test:测试阶段依赖</li>
</ul>
<pre><code class="lang-bash">&lt;dependency&gt;
    &lt;groupId&gt;org.jiaoper/groupId&gt;
    &lt;artifactId&gt;utils-common&lt;/artifactId&gt;
    &lt;version&gt;3.0-alpha-1&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<ul>
<li>compile:编译、测试和运行阶段依赖(默认)</li>
</ul>
<pre><code class="lang-bash">&lt;dependency&gt;
    &lt;groupId&gt;org.jiaoper/groupId&gt;
    &lt;artifactId&gt;utils-common&lt;/artifactId&gt;
    &lt;version&gt;3.0-alpha-1&lt;/version&gt;
    &lt;scope&gt;complie&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<hr>
<h1 id="运维-linux"><a href="#运维-linux" class="headerlink" title="运维/linux"></a>运维/linux</h1><p><strong>Q：利用nginx共享文件夹</strong></p>
<p>nginx.conf添加如下配置</p>
<pre><code>server {
    listen       8000;
    server_name  localhost;
    charset utf-8;
    location / {
    root /home;#共享根目录下的home文件夹
    # 索引
    autoindex on;
    # 显示文件大小
    autoindex_exact_size on;
    # 显示文件时间
    autoindex_localtime on;
    #index  index.html index.htm;
  }
}
</code></pre><p><strong>Q:更改ubuntu源为阿里云源</strong></p>
<pre><code class="lang-bash">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak

sudo vim /etc/apt/source.list

deb-src http://archive.ubuntu.com/ubuntu xenial main restricted #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe
deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse
deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse #Added by software-properties
deb http://archive.canonical.com/ubuntu xenial partner
deb-src http://archive.canonical.com/ubuntu xenial partner
deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted
deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe #Added by software-properties
deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe
deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse

apt-get update 

#or
mv /etc/apt/sources.list /etc/apt/sources.list.bak
echo &quot;deb http://mirrors.163.com/debian/ jessie main non-free contrib&quot; &gt;&gt; /etc/apt/sources.list
echo &quot;deb http://mirrors.163.com/debian/ jessie-proposed-updates main non-free contrib&quot; &gt;&gt;/etc/apt/sources.list
echo &quot;deb-src http://mirrors.163.com/debian/ jessie main non-free contrib&quot; &gt;&gt;/etc/apt/sources.list
echo &quot;deb-src http://mirrors.163.com/debian/ jessie-proposed-updates main non-free contrib&quot; &gt;&gt;/etc/apt/sources.list

apt-get update
</code></pre>
<p><strong>Q:oracle导入dmp备份文件</strong></p>
<pre><code>[root@centos ～]# su - oracle
[oracle@centos ～]# sqlplus 
请输入用户名:  sys as sysdba
输入口令:
SQL&gt; CREATE USER 用户 IDENTIFIED BY 密码;
User created.

SQL&gt; GRANT CONNECT, RESOURCE, DBA TO 用户;
Grant succeeded.
SQL&gt; CONNECT 用户@orcl #新用户测试登陆
</code></pre><p>复制*.dmp文件到linux并加权</p>
<pre><code>[root@centos ～]# chmod 777 *.dmp
</code></pre><p>导入dmp数据库备份文件</p>
<pre><code>[root@centos ～] su - oracle
[oracle@centos ～]imp 用户名/密码@orcl file=/home/*.dmp ignore=y full=y;
 Import terminated successfully with warnings.(成功)
</code></pre><p><strong>Q：scp文件/目录上传/下载</strong></p>
<pre><code class="lang-java">#本地上传到远程
#文件
scp /root/test.json root@远程服务器ip:/usr/local/src
#目录
scp -r /home/testdir root@远程服务器ip:/home/testdir

#远程下载到本地
#文件
scp root@远程服务器ip:/usr/local/src/test.json /root/
#目录
scp -r root@远程服务器ip:/home/testdir /home/
</code></pre>
<p><strong>Q：Ubuntu增加swap交换空间</strong></p>
<pre><code class="lang-bash">$ free -m #查看分区大小
$ dd if=/dev/zero of=/swapfile bs=1M count=3k #创建count*bs大小的swap文件
$ mkswap /swapfile #创建swap空间
$ swapon /swapfile #设置分区有效 ,swapoff 设置分区无效
$ vim /etc/fstab #开启启动：添加/swapfile swap swap defaults 0 0
</code></pre>
<p><strong>Q：git创建分支</strong></p>
<pre><code class="lang-bash">git clone -b &lt;指定分支名&gt; &lt;远程仓库地址&gt; #克隆指定分支
git branch -a  #查看分支
git branch &lt;分支名&gt; #创建分支
git checkout &lt;分支名&gt; #切换到分支
git add . #提交
git commit -m &quot;&quot; 
git push origin &lt;分支名&gt;
</code></pre>
<p><strong>Q：git 子模块</strong></p>
<pre><code class="lang-bash">#添加
git submodule add &lt;url&gt; &lt;path&gt;
git submodule init
git submodule update
git submodule update --init --recursive

#删除
rm -rf 子模块源码目录
#删除子模块项
vi .gitmodules 
vi .git/config 
rm .git/module/子模块目录
git rm --cached 子模块名称
</code></pre>
<p><strong>Q：glibc升级</strong></p>
<pre><code class="lang-bash">#http://ftp.gnu.org/gnu/glibc/
wget http://ftp.gnu.org/gnu/glibc/glibc-2.23.tar.gz
tar -zxvf glibc-2.23.tar.gz
cd glibc-2.23
mkdir build
cd build
./configure --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin
make &amp;&amp; make install 

&#39;&#39;&#39;
gawk: error while loading shared libraries: /lib64/libm.so.6: invalid ELF header
# 打开新终端执行如下命令
# cd /lib64
# unlink libm.so.6
# ln -s libm-2.23.so libm.so.6
# 回到原终端执行 make install
&#39;&#39;&#39;
</code></pre>
<p><strong>Q：libstdc++升级</strong></p>
<pre><code class="lang-bash">#下载最新版libstdc++
mv /usr/lib64/libstdc++.so.6  /usr/lib64/libstdc++.so.6.bak
ln -s /usr/lib64/libstdc++.so.6.0.26  /usr/lib64/libstdc++.so.6
</code></pre>
<p><strong>Q：linux免密登录</strong></p>
<pre><code class="lang-bash">$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/worker/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/worker/.ssh/id_rsa
Your public key has been saved in /home/worker/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:PmhwBGI0Gqgx8mCl5mHvj8ogyEfV9jnrzmLuKb2mOxQ worker@normalserver.inm.inner
The key&#39;s randomart image is:
+---[RSA 3072]----+
|o.*..            |
|*=.o ..          |
|=X   ..o         |
|= + .E. . .      |
| . o. o S+       |
|o o  + o  o      |
|+. o. + o.       |
|+ . o+ =+.       |
| o.. +X=++       |
+----[SHA256]-----+

#复制id_rsa.pub内容追加至目标连接主机.ssh/authorized_keys
$ ssh-copy-id -i ~/.ssh/id_rsa.pub worker@10.100.3.27
#手动方式
$ cd ~ 
$ mkdir .ssh &amp;&amp; chmod 700 .ssh
$ cd .ssh
$ touch id_rsa.pub # 复制ssh-keygen主机的id_rsa.pub内容置此
$ cat id_rsa.pub &gt;&gt; authorized_keys
$ chmod 600 authorized_keys
</code></pre>

            <hr>
          </div>
          <br>
          <div>
            <p>
            
              <span>
                <i class="iconfont icon-inbox"></i>
                
                  <a class="hover-with-bg" href="/categories/%E7%AC%94%E8%AE%B0">笔记</a>
                  &nbsp;
                
              </span>&nbsp;&nbsp;
            
            
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/%E5%B0%8F%E8%B4%B4%E5%A3%AB">小贴士</a>
                
              </span>
            
            </p>
            
              <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
            
          </div>
        </div>
      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;ディレクトリ</p>
    <div id="tocbot"></div>
  </div>

    </div>
  </div>
</div>

<!-- custom -->


<!-- Comments -->
<div class="col-lg-7 mx-auto nopadding-md">
  <div class="container comments mx-auto" id="comments">
    
      <br><br>
      
      
  <script defer src="https://utteranc.es/client.js"
          repo="JiaoPaner/blog-talk"
          issue-term="pathname"
  
          label="utterances"
    
          theme="github-light"
          crossorigin="anonymous"
          async>
  </script>


    
  </div>
</div>

    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">検索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">キーワード</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  <footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    <br>

    
  
    <!-- 不蒜子统计PV -->
    
    &nbsp;<span id="busuanzi_container_site_pv">总访问量 
          <span id="busuanzi_value_site_pv"></span> 次</span>&nbsp;
  
  
    <!-- 不蒜子统计UV -->
    
    &nbsp;<span id="busuanzi_container_site_uv">总访客数 
            <span id="busuanzi_value_site_uv"></span> 人</span>&nbsp;
  
  <br>



    


    <!-- cnzz Analytics icon -->
    

  </div>
</footer>

<!-- SCRIPTS -->
<script src="/lib/jquery/jquery.min.js" ></script>
<script src="/lib/popper/popper.min.js" ></script>
<script src="/lib/bootstrap/js/bootstrap.min.js" ></script>
<script src="/lib/mdbootstrap/js/mdb.min.js" ></script>
<script src="/js/main.js" ></script>


  <script src="/js/lazyload.js" ></script>



  
    <script src="/lib/tocbot/tocbot.min.js" ></script>
  
  <script src="/js/post.js" ></script>



  <script src="/lib/smooth-scroll/smooth-scroll.min.js" ></script>



  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>


<!-- Plugins -->


  

  

  

  

  <!-- cnzz Analytics -->
  



  <script src="/lib/prettify/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="/lib/typed/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "小贴士&nbsp;",
      ],
      cursorChar: ".",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="/lib/anchor/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "false",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script src="/lib/fancybox/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>



  

  
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
              processEscapes: true,
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
      });

      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });

    </script>

    <script src="https://cdn.staticfile.org/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML" ></script>

  









</body>
</html>
